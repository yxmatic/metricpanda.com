<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Video recording for game development | Metric Panda Games</title><meta name=description content="Having a way to capture game video footage is essential for any Indie game developer.It can allow you to: Store videos for visual comparisions of different builds (useful when ..."><meta name=keywords><meta property=og:title content="Video recording for game development | Metric Panda Games"><meta property=og:type content=website><meta property=og:locale content=en_US><meta property=og:url content="https://metricpanda.com/rival-fortress-update-15-video-recording-for-game-development/"><meta property=og:image content=https://metricpanda.commetric-panda-1024x1024.png><meta name=twitter:title content="Video recording for game development"><meta name=twitter:card content=summary_large_image><meta name=twitter:site content=@MetricPandaGame><meta name=twitter:creator content=@Unspongeful><meta name=twitter:description content="Having a way to capture game video footage is essential for any Indie game developer.It can allow you to: Store videos for visual comparisions of different builds (useful when ..."><meta name=twitter:url content="https://metricpanda.com/rival-fortress-update-15-video-recording-for-game-development/"><meta name=twitter:url content="https://metricpanda.com/rival-fortress-update-15-video-recording-for-game-development/"><meta name=twitter:image content=https://metricpanda.commetric-panda-1024x1024.png><meta name=twitter:image:alt content="Video recording for game development"><link rel=canonical href="https://metricpanda.com/rival-fortress-update-15-video-recording-for-game-development/"><link rel=alternate type=application/rss+xml title="Metric Panda Games" href=https://metricpanda.com/feed.xml><link rel=apple-touch-icon href=apple-icon-precomposed.png><link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64" href=https://metricpanda.com/favicon.ico><link data-turbolinks-track=reload rel=stylesheet type=text/css href=/assets/metricpanda-39b1a813586a62f5ab272a1dc423ec22fa36f235ccc08b5ec4a21a2c11cc3fe9.css></head><body><header class="header clearfix"><nav class="navbar navbar-custom js-navbar navbar-fixed-top"><div class=container><h3 class=text-muted><a href="/" class=title-backlink><span class=logo-icon><i class="logo-state sprite sprite-small-logo"></i></span><span class=logo-name>MPG</span></a></h3><ul class=nav><li class="nav-link-important nav-link"><a class=nav-action href=/rival-fortress>rival fortress</a></li><li class=nav-separator><i class="icon icon-circle"></i></li><li class=nav-link><a class=nav-action href="/">news</a></li><li class=nav-link><a class=nav-action href=/press.html>press</a></li><li class=nav-link><a data-turbolinks=false class="nav-action js-search-button search-button" href="/">&nbsp;<i class="icon icon-search"></i></a></li></ul></div></nav><section class="masthead js-masthead"><div class=masthead-home><div class=metric-panda-logo><a href="/" class="sprite sprite-logo"></a></div><h1>Metric Panda Games</h1><h2>One pixel at a time.<i></i></h2></div><div class="home-nav clearfix"><ul class="nav nav-pills"><li class=nav-item><span class="nav-block nav-title">News:</span></li><li class=nav-item><a class="nav-block nav-link" href="/">Featured</a></li><li class=nav-item><a class="nav-block nav-link" href="/news/">All</a></li><li class=nav-item><a class="nav-block nav-link" href=/news/rival-fortress.html>Rival Fortress</a></li><li class=nav-item><a class="nav-block nav-link" href=/news/other.html>Other</a></li></ul></div><div><div class="js-masthead-rainbow masthead-rainbow"><i></i></div></div></section></header><section class="js-search-results search-results"><div class="container page-content"><form class="js-search-form search-form"><div class=input-group><input type=text class="form-control js-search-query" placeholder=Search...> <span class=input-group-btn><button class="btn btn-primary" type=submit>Search</button></span></div></form><div class="js-search-results-list search-results-list posts post-list"></div><div class="js-search-results-listing js-search-result-status search-result-status search-result-listing"><button type=button class="btn btn-success js-close-search">Close <i class="icon icon-cancel-1"></i></button></div><div class="js-search-results-loading js-search-result-status search-result-status search-result-loading"><button type=button class="btn btn-info js-close-search">Loading...</button></div><div class="js-search-results-empty js-search-result-status search-result-status search-result-empty"><button type=button class="btn btn-danger js-close-search">No results found <i class="icon icon-cancel-1"></i></button></div></div></section><section class="js-main-content main-content"><article class="page-width post-page container page-content"><header class=post-header><h1 class=post-title>Video recording for game development</h1><p class=game-update><a href=rival-fortress>Rival Fortress Update #15</a></p><p class=post-meta>by <em>Gianni Milanesi</em> <span class=dot>•</span> Category: <a href=/news/rival-fortress.html>Rival Fortress</a></p></header><div class=post-content><p>Having a way to capture game video footage is essential for any Indie game developer.</p><p>It can allow you to:</p><ul><li>Store videos for visual comparisions of different builds (useful when testing)</li><li>Capture gameplay demos to share online</li><li>Have a video of the last few seconds before a crash</li></ul><p>There are many software packages out there that allow you to capture game footage, like FRAPS, Camtasia or OBS.</p><p>In this post I’ll talk about how to easily roll your own custom solution in order to have much more power and flexibility over how and when you capture.</p><h1 id=the-building-blocks-of-screen-capture>The building blocks of screen capture</h1><p><a href="https://www.ffmpeg.org/">FFmpeg</a> is an open-source cross-platform “swiss army knife” of video and audio manipulation. It’s a must have if you are doing any kind of video or audio work (which you are if you are an indie dev).</p><p><a href="http://apitrace.github.io/">Apitrace</a> is a set of tools that can record and playback OpenGL and Direct3D calls made by an application with relatively little overhead. Apart from being an excellent debugging tool it may be repurposed as game video capturer with a little bit of work on your part.</p><h1 id=capturing-by-piping-frames-to-ffmpeg>Capturing by piping frames to FFmpeg</h1><p>The most powerful way to do screen capturing of your game is to stream raw pixel data directly from the backbuffer of your game to disk.</p><p>This can be done easily in OpenGL with a call to <a href=https://www.khronos.org/opengles/sdk/docs/man/xhtml/glReadPixels.xml>glReadPixels</a> or in Direct3D with <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ff476394(v=vs.85).aspx">CopySubresourceRegion</a>.</p><p>The problem of writing RGB pixel data to disk is that the files produced are huge and not really practical if you want to record long sessions.</p><p>A better approach is to pipe the data directly into FFmpeg as described by Miles Macklin in his post <a href="http://blog.mmacklin.com/2013/06/11/real-time-video-capture-with-ffmpeg/">Real-Time Video Capture with FFmpeg</a>. This approach trades off disk I/O with a bit of CPU overhead required by FFmpeg to do the encoding. In my experience the overhead is perfectly acceptable and on par with FRAPS, that to my knowledge is the most lightweight capturing solution.</p><p>In his post he uses <code class=highlighter-rouge>GL_RGBA</code> as output format, but I suggest you use <code class=highlighter-rouge>GL_RGB</code>, as this will reduce the bandwidth required by 25% with no quality loss. Also if you are on Unix based system you have to use <code class=highlighter-rouge>popen</code> and <code class=highlighter-rouge>pclose</code> instead of <code class=highlighter-rouge>_popen</code> and <code class=highlighter-rouge>_pclose</code>.</p><h1 id=capturing-with-apitrace>Capturing with apitrace</h1><p>An alternative method of low overhead capturing is with apitrace. I’ve only tried this on Linux and OSX, so your mileage may vary if you are on Windows.</p><p>As explained in the <a href=https://github.com/apitrace/apitrace/blob/master/docs/USAGE.markdown>documentation</a> you can use the following commands to record to video:</p><ol><li>Capture a trace of your game by running it like so:</li></ol><figure class=highlight><pre><code class=language-bash data-lang=bash>apitrace trace game-executable</code></pre></figure><ol><li>From the command line run:</li></ol><figure class=highlight><pre><code class=language-bash data-lang=bash>apitrace dump-images <span class=nt>-o</span> - game-executable.trace <span class=se>\</span>
| ffmpeg <span class=nt>-r</span> 30 <span class=nt>-f</span> image2pipe <span class=nt>-vcodec</span> ppm <span class=nt>-i</span> pipe: <span class=nt>-vcodec</span> mpeg4 <span class=nt>-y</span> output.mp4</code></pre></figure><p>A little more work is required to “cut” the video to only the part that interest you, either using the apitrace <code class=highlighter-rouge>trim</code> command, or by editing the video in an external software.</p><aside class="share readable"><span>Share this:</span> <a href="http://twitter.com/share?text=Rival Fortress Update #15: Video recording for game development&amp;url=https://metricpanda.com/rival-fortress-update-15-video-recording-for-game-development/index.html" class=js-analytics data-target=twitter-share onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"><i class="icon icon-twitter"></i></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://metricpanda.com/rival-fortress-update-15-video-recording-for-game-development/index.html" class=js-analytics data-target=facebook-share onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"><i class="icon icon-facebook"></i></a></aside></div><hr class=hr><div class="page-width newsletter-form"><form action=https://tinyletter.com/metricpanda class=js-analytics-form data-target=newsletter-submit method=post target=popupwindow onsubmit="window.open('https://tinyletter.com/metricpanda', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true"><label for=tlemail><b>Metric Panda Digest</b> <em>(sent monthly and <a data-turbolinks=false class=js-analytics data-target=newsletter-preview href=/newsletters/newsletter-2016-september.html>looks like this</a>)</em></label><div class=input-group><input type=email name=email class=form-control id=tlemail placeholder="Enter your email" required> <input type=hidden value=1 name=embed> <span class=input-group-btn><button class="btn btn-primary" type=submit>Submit</button></span></div><small class=text-muted>We hate spam as much as you do!</small></form></div><hr class=hr></article></section><footer class="site-footer clearfix"><ul class="social js-social"><li><a href=https://github.com/MetricPanda class=js-analytics data-target=github-metricpanda-footer target=_blank><i class="icon icon-github-circled"></i> <b>Github</b></a></li></ul><small>&copy; 2019 Metric Panda Games All rights reserved. <i class="icon icon-star-empty" title=d32745f></i></small><div class=footer-logo><i class="icon icon-metric-panda"></i></div></footer><script data-turbolinks-track=reload data-turbolinks-eval=false type=text/javascript src=/assets/metricpanda-642bfda95fce5f4276f3ac16fa8c8ff98d1d3ef275ab201acce574d9b5d1888f.js></script></body></html>